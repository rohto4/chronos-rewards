# Chronos Rewards - プロジェクト要件定義書
Version: 1.0  
Date: 2026-01-31  
Author: @unibell4

---

## 1. プロジェクト概要

### 1.1 プロジェクト名
**Time-Staged Task Manager "Chronos Rewards"**

### 1.2 目的
短期（今日）から超長期（3年）までのタスクを「時限別」に管理し、立案と消化で異なる報酬（コイン/クリスタル）を得るゲーミフィケーション・タスク管理アプリ。PCとスマホ（Android PWA）でリアルタイム同期する。

### 1.3 ターゲットユーザー
- 長期的な目標管理を必要とする個人ユーザー
- PCとスマホを併用してタスク管理を行うユーザー
- ゲーミフィケーション要素でモチベーションを維持したいユーザー

---

## 2. 技術スタック

### 2.1 フロントエンド
- **Framework**: Next.js 14+ (App Router)
- **Styling**: Tailwind CSS
- **UI Components**: shadcn/ui (Base), Lucide React (Icons)
- **Animation**: Framer Motion
- **PWA**: next-pwa

### 2.2 バックエンド・データベース
- **BaaS**: Supabase
  - Authentication (Google OAuth)
  - PostgreSQL Database
  - Realtime Subscription

### 2.3 デプロイ・ホスティング
- **Platform**: Vercel
- **Repository**: GitHub (Private)

### 2.4 開発環境
- **OS**: Windows
- **Node.js**: v22.13.0
- **Package Manager**: npm (推奨)
- **Editor**: VSCode

---

## 3. 機能要件

### 3.1 時限フィルタリング・ダッシュボード

#### 3.1.1 フィルタチップ
- 表示期間: 今日/今週/2週間/1ヶ月/3ヶ月/1年/3年
- 複数選択可能（累積表示）
- 期限切れタスクの表示/非表示トグルスイッチ

#### 3.1.2 タスクカード表示
- **ソート順**: 期限が近い順
- **表示項目**:
  - タスク名
  - やるメリット（小フォント、常時表示）
  - ジャンル（色付き■マーク）
  - 期限日付
  - 重さ（時間）
  - 親子関係の階層表示
- **操作**:
  - スワイプ右: 完了
  - スワイプ左: 削除
  - タップ: 詳細表示・編集
  - PC版: ホバー時にボタン表示

#### 3.1.3 ジャンル（カテゴリ）
- 自由入力形式
- 一度使用したジャンルはプルダウンに表示
- ジャンル別フィルタリング機能
- 色分け: ■マーク程度の控えめな表現

### 3.2 デュアル・クイック登録

#### 3.2.1 登録ボタン
下部に2つの巨大な「＋」ボタンを配置

1. **「短期/Routine」ボタン**
   - 初期値: 時限=今週、重さ=1h
   
2. **「長期/Project」ボタン**
   - 初期値: 時限=3ヶ月、重さ=10h

#### 3.2.2 入力項目
- **必須**:
  - タスク名
  - 期限（カレンダーピッカー）
- **任意**:
  - ジャンル（自由入力 + 既存タグからプルダウン選択）
  - 内容（詳細説明）
  - 前提条件（チェックリスト形式）
  - 重さ（単位: 時間）
  - やるメリット

#### 3.2.3 親子タスク
- 親タスクから子タスクを無制限に作成可能
- ネスト深度: 無制限（孫、ひ孫...も可能）
- 親タスクの進捗は子タスクの完了率で自動計算
- 子タスクの作成タイミングは自由（親タスク作成後いつでも追加可能）

### 3.3 報酬・ゲームシステム

#### 3.3.1 通貨システム
1. **コイン（Gold）**
   - 獲得タイミング: タスク立案時
   - 基本報酬: 10コイン
   - ボーナス条件:
     - タスクの詳細度に応じて最大2倍（10→20コイン）
     - 前提条件入力: +1.2倍
     - メリット入力: +1.2倍
   - 編集時の加筆でも追加獲得可能

2. **クリスタル（Crystal）**
   - 獲得タイミング: タスク消化時
   - 基本報酬: 重さに応じて算出（設計時に詳細決定）
   - ボーナス条件:
     - 前提条件・メリット記入済み: +1.2倍
     - 親タスク完了: 大量クリスタル

#### 3.3.2 スタミナシステム
- **最大値**: 100
- **回復**: 時間経過で自動回復（レート: 設計時に決定）
- **消費タイミング**:
  - タスク作成: 基本消費
  - タスク詳細化（前提条件・メリット追加）: +2スタミナ消費
  - タスク編集（加筆時）: 基本消費
  - タスク消化: スタミナ消費なし（報酬のみ）
  - 簡易日報作成: 消費あり
- **目的**: 過度な一気行動を抑制し、適度なペース維持

#### 3.3.3 親子タスクボーナス
- 長期タスクを子タスクに分解: ボーナス獲得
- 親タスク完了時: 大量クリスタル獲得

#### 3.3.4 加点方式
- ペナルティなし（期限切れでも減点なし）
- 連続ログイン、コンボを重視

### 3.4 統計・シェア機能

#### 3.4.1 統計画面
- 使用時間（累計・期間別）
- 消化数（期間別）
- 立案数（期間別）
- ジャンル別集計
- 獲得コイン・クリスタル推移

#### 3.4.2 シェア機能
- スクリーンショット想定（画像生成機能なし）
- PC・スマホ両方で1画面に収まるレイアウト
- 表示内容:
  - 実績
  - アイコン
  - ランク
  - クレジット「@unibell4」

---

## 4. UI/UX指針

### 4.1 デザインテーマ
- **カラー**: ダークモードオンリー
- **トーン**: クールで落ち着いた雰囲気
- **アクセント**: ジャンルの色分けは控えめ（■マーク程度）

### 4.2 レスポンシブ対応
- **PC**: 大画面を活かしたグリッド表示
- **スマホ**: シングルカラム表示
- **タブレット**: 中間的なレイアウト

### 4.3 アニメーション
- **コンセプト**: Habiticaほど過剰ではなく「小気味よい」演出
- **例**:
  - タスク完了時: クリスタルが飛ぶアニメーション
  - カード追加時: スライドイン
  - 報酬獲得時: コイン・クリスタルのカウントアップ
- **パフォーマンス**: Xiaomi 15無印（ハイスペック）での動作を想定

### 4.4 PWA要件
- **インストール**: Chrome等でインストールボタンから手動インストール
- **オフライン対応**: 必須（編集もオフラインで可能）
- **同期**: オンライン復帰時に自動同期（または同期ボタン）
- **プッシュ通知**: 不要

---

## 5. データ同期仕様

### 5.1 リアルタイム同期
- **方式**: Supabase Realtime
- **対象**: タスク、報酬、スタミナ、統計データ
- **デバイス**: PC ↔ スマホ

### 5.2 競合解決
- **基本方針**: 統合（DELETE操作は稀のため）
- **例外**: 統合不可の場合はPC優先

### 5.3 オフライン対応
- **編集**: オフライン時も編集可能
- **同期**: オンライン復帰時に自動同期（数秒単位なら同期ボタンでも可）
- **キャッシュ**: Service Workerで静的リソースをキャッシュ

---

## 6. セキュリティ・認証

### 6.1 認証方式
- **Google OAuth**: Supabase Auth使用
- **セッション管理**: Supabase標準機能

### 6.2 データアクセス制御
- **Row Level Security (RLS)**: 有効化
- **ポリシー**: ユーザーは自分のデータのみアクセス可能

---

## 7. 開発環境・デプロイ

### 7.1 ローカル開発
- **OS**: Windows
- **Node.js**: v22.13.0
- **Editor**: VSCode
- **環境変数**: `.env.local`（Gitにコミットしない）

### 7.2 リポジトリ管理
- **Platform**: GitHub
- **可視性**: Private
- **ブランチ戦略**: main（本番）, develop（開発）推奨

### 7.3 デプロイ
- **Platform**: Vercel
- **自動デプロイ**: GitHub連携
- **環境変数**: Vercel Dashboardで設定

---

## 8. プロジェクト構成

```
chronos-rewards/
├── app/                # Next.js App Router
│   ├── layout.tsx      # ルートレイアウト
│   ├── page.tsx        # ダッシュボード（メイン画面）
│   ├── auth/           # 認証関連ページ
│   │   ├── login/
│   │   └── callback/
│   ├── stats/          # 統計画面
│   │   └── page.tsx
│   └── api/            # API Routes
│       └── sync/       # 同期関連API
├── components/         # 再利用可能なコンポーネント
│   ├── ui/             # shadcn/ui ベースコンポーネント
│   ├── tasks/          # タスク関連コンポーネント
│   │   ├── TaskCard.tsx
│   │   ├── TaskForm.tsx
│   │   ├── QuickAddButtons.tsx
│   │   └── FilterChips.tsx
│   └── rewards/        # 報酬関連コンポーネント
│       ├── CoinDisplay.tsx
│       ├── CrystalDisplay.tsx
│       └── StaminaBar.tsx
├── lib/                # ユーティリティ
│   ├── supabase/       # Supabase client設定
│   │   ├── client.ts
│   │   └── server.ts
│   ├── utils/          # 汎用関数
│   │   ├── rewards.ts  # 報酬計算ロジック
│   │   └── dates.ts    # 日付処理
│   └── hooks/          # カスタムフック
│       ├── useTasks.ts
│       └── useRewards.ts
├── public/             # PWA用アセット
│   ├── icons/          # アプリアイコン
│   ├── manifest.json   # PWA Manifest
│   └── sw.js           # Service Worker
├── styles/             # グローバルCSS
│   └── globals.css
├── .env.local          # 環境変数（Gitにコミットしない）
├── .gitignore
├── next.config.js      # Next.js設定（PWA含む）
├── tailwind.config.js  # Tailwind CSS設定
├── tsconfig.json       # TypeScript設定
└── package.json
```

---

## 9. 開発フェーズ

### Phase 1: 環境セットアップ（完了予定: Day 1）
- Vercel・Supabaseアカウント作成
- Next.jsプロジェクト初期化
- PWA設定
- Google OAuth設定

### Phase 2: データベース設計・実装（完了予定: Day 2-3）
- Supabaseテーブル設計
- RLSポリシー設定
- リアルタイム同期設定

### Phase 3: コア機能実装（完了予定: Day 4-7）
- タスクCRUD
- 親子タスク機能
- 報酬システム
- スタミナシステム

### Phase 4: UI/UX実装（完了予定: Day 8-10）
- ダッシュボード
- フィルタリング
- デュアルクイック登録
- スワイプ操作

### Phase 5: オフライン対応（完了予定: Day 11-12）
- Service Worker実装
- オフライン編集
- 同期ロジック

### Phase 6: 統計・仕上げ（完了予定: Day 13-14）
- 統計画面
- アニメーション調整
- パフォーマンス最適化
- テスト・デバッグ

---

## 10. 参考リンク

### 公式ドキュメント
- Next.js: https://nextjs.org/docs
- Tailwind CSS: https://tailwindcss.com/docs
- Supabase: https://supabase.com/docs
- Framer Motion: https://www.framer.com/motion/
- shadcn/ui: https://ui.shadcn.com/
- Lucide React: https://lucide.dev/guide/packages/lucide-react

### PWA関連
- next-pwa: https://github.com/shadowwalker/next-pwa
- MDN PWA Guide: https://developer.mozilla.org/ja/docs/Web/Progressive_web_apps

---

## 11. 変更履歴

| Version | Date       | Author     | Changes                |
|---------|------------|------------|------------------------|
| 1.0     | 2026-01-31 | @unibell4  | 初版作成               |

---

## 12. 補足・備考

### 12.1 設計の柔軟性
- 報酬計算の具体的な数値（クリスタル獲得量など）は実装時に調整可能
- スタミナ回復速度は運用しながらバランス調整
- アニメーションの演出強度はフィードバックを元に調整

### 12.2 将来的な拡張可能性
- マルチユーザー対応（チーム機能）
- ランキング機能
- カスタムテーマ
- 統計のグラフ化
- エクスポート機能（CSV/JSON）

---

**End of Document**
